import { PrismaClient } from '@prisma/client'
import { AuthService } from '../src/lib/auth'

const prisma = new PrismaClient()

async function main() {
  console.log('ðŸ”§ Ð¡Ð¾Ð·Ð´Ð°Ð½Ð¸Ðµ ÑÐ¸ÑÑ‚ÐµÐ¼Ð½Ñ‹Ñ… Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÐµÐ¹...')

  // 1. Ð¡Ð¾Ð·Ð´Ð°ÐµÐ¼ ÑÐ¸ÑÑ‚ÐµÐ¼Ð½Ð¾Ð³Ð¾ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ Ð´Ð»Ñ Telegram Ð±Ð¾Ñ‚Ð°
  const telegramBotUser = await prisma.user.upsert({
    where: { username: 'telegram-bot' },
    update: {},
    create: {
      username: 'telegram-bot',
      firstName: 'Telegram',
      lastName: 'Bot',
      password: await AuthService.hashPassword('system-password-never-used'),
      role: 'ADMIN', // Ð¡Ð¸ÑÑ‚ÐµÐ¼Ð½Ñ‹Ð¹ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒ Ñ Ð¿Ñ€Ð°Ð²Ð°Ð¼Ð¸ Ð°Ð´Ð¼Ð¸Ð½Ð¸ÑÑ‚Ñ€Ð°Ñ‚Ð¾Ñ€Ð°
      isActive: true,
      officeIds: [], // Ð¡Ð¸ÑÑ‚ÐµÐ¼Ð½Ñ‹Ð¹ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒ Ð½Ðµ Ð¿Ñ€Ð¸Ð²ÑÐ·Ð°Ð½ Ðº Ð¾Ñ„Ð¸ÑÐ°Ð¼
    },
  })

  console.log('âœ… Telegram Bot Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒ ÑÐ¾Ð·Ð´Ð°Ð½:', telegramBotUser.id)

  // 2. Ð¡Ð¾Ð·Ð´Ð°ÐµÐ¼ Ð¾Ð±Ñ‰ÐµÐ³Ð¾ ÑÐ¸ÑÑ‚ÐµÐ¼Ð½Ð¾Ð³Ð¾ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ
  const systemUser = await prisma.user.upsert({
    where: { username: 'system' },
    update: {},
    create: {
      username: 'system',
      firstName: 'System',
      lastName: 'User',
      password: await AuthService.hashPassword('system-password-never-used'),
      role: 'ADMIN', // Ð¡Ð¸ÑÑ‚ÐµÐ¼Ð½Ñ‹Ð¹ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒ Ñ Ð¿Ñ€Ð°Ð²Ð°Ð¼Ð¸ Ð°Ð´Ð¼Ð¸Ð½Ð¸ÑÑ‚Ñ€Ð°Ñ‚Ð¾Ñ€Ð°
      isActive: true,
      officeIds: [], // Ð¡Ð¸ÑÑ‚ÐµÐ¼Ð½Ñ‹Ð¹ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒ Ð½Ðµ Ð¿Ñ€Ð¸Ð²ÑÐ·Ð°Ð½ Ðº Ð¾Ñ„Ð¸ÑÐ°Ð¼
    },
  })

  console.log('âœ… System Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒ ÑÐ¾Ð·Ð´Ð°Ð½:', systemUser.id)

  // 3. Ð¡Ð¾Ð·Ð´Ð°ÐµÐ¼ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ Ð´Ð»Ñ API Ð¾Ð¿ÐµÑ€Ð°Ñ†Ð¸Ð¹
  const apiUser = await prisma.user.upsert({
    where: { username: 'api-system' },
    update: {},
    create: {
      username: 'api-system',
      firstName: 'API',
      lastName: 'System',
      password: await AuthService.hashPassword('system-password-never-used'),
      role: 'ADMIN',
      isActive: true,
      officeIds: [],
    },
  })

  console.log('âœ… API System Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒ ÑÐ¾Ð·Ð´Ð°Ð½:', apiUser.id)

  console.log('ðŸŽ‰ Ð’ÑÐµ ÑÐ¸ÑÑ‚ÐµÐ¼Ð½Ñ‹Ðµ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ð¸ ÑÐ¾Ð·Ð´Ð°Ð½Ñ‹ ÑƒÑÐ¿ÐµÑˆÐ½Ð¾!')
}

main()
  .catch((e) => {
    console.error('âŒ ÐžÑˆÐ¸Ð±ÐºÐ° Ð¿Ñ€Ð¸ ÑÐ¾Ð·Ð´Ð°Ð½Ð¸Ð¸ ÑÐ¸ÑÑ‚ÐµÐ¼Ð½Ñ‹Ñ… Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÐµÐ¹:', e)
    process.exit(1)
  })
  .finally(async () => {
    await prisma.$disconnect()
  })
